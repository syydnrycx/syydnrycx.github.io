<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Syydnrycx</title>
  
  <subtitle>Life-long learning</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://syydnrycx.github.io/"/>
  <updated>2018-09-13T15:29:17.264Z</updated>
  <id>https://syydnrycx.github.io/</id>
  
  <author>
    <name>Syydnrycx</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Android Studio adb shell 无法设置为超级用户的解决方法</title>
    <link href="https://syydnrycx.github.io/2018/09/13/Android-Studio-adb-shell-%E6%97%A0%E6%B3%95%E8%AE%BE%E7%BD%AE%E4%B8%BA%E8%B6%85%E7%BA%A7%E7%94%A8%E6%88%B7%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <id>https://syydnrycx.github.io/2018/09/13/Android-Studio-adb-shell-无法设置为超级用户的解决方法/</id>
    <published>2018-09-13T14:21:27.000Z</published>
    <updated>2018-09-13T15:29:17.264Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/09/13/Android-Studio-adb-shell-无法设置为超级用户的解决方法/fengmian.jpg" alt=""><br><a id="more"></a></p><div class="aplayer" data-id="553755659" data-server="netease" data-type="song"></div><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul><li>在学习郭霖著的<strong>《第一行代码》</strong>时，其中在 SQLite 数据库存储时要运用 <strong>adb shell</strong> 访问数据库文件时，无法设置权限为超级管理员权限，为此停滞了好久，后来上网查询后知道 <strong>Android7.0 虚拟机没有root权限</strong>。</li><li>所以我们在 <strong>adb shell</strong> 执行命令 <strong>su</strong> 回应 <strong>not found</strong> 。</li></ul><p><img src="/2018/09/13/Android-Studio-adb-shell-无法设置为超级用户的解决方法/1.png" alt=""></p><h1 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h1><ul><li>既然 <strong>Android 7.0 虚拟机无法设置权限</strong>，那我们退而求其次使用 <strong>Android 6.0的虚拟机</strong> 就可以设置超级管理员权限。</li><li>所以我们可以进入 <strong>Android Virtual Device Manager</strong> 新建一个虚拟机，点击 <strong>Create Virtual Device..</strong> ，选择一个机型后我们点击 <strong>next</strong>，<br><img src="/2018/09/13/Android-Studio-adb-shell-无法设置为超级用户的解决方法/3.png" alt=""><br><img src="/2018/09/13/Android-Studio-adb-shell-无法设置为超级用户的解决方法/4.png" alt=""></li><li>我们下载一个7.0以下的版本，这里我选择了一个 <strong>Android 6.0版本</strong> 的虚拟机，设置好后，我把我的 app 装在新的虚拟机上，并且在 cmd 上输入 <strong>adb shell</strong>，这时候我们可以看到从之前的 <strong>$：普通管理员</strong>，自动的变为 <strong>#：超级管理员</strong>。假如没有自动设置为 <strong>#：超级管理员</strong>的话我们可以通过 <strong>su</strong> 来设置。<br><img src="/2018/09/13/Android-Studio-adb-shell-无法设置为超级用户的解决方法/5.png" alt=""><br><img src="/2018/09/13/Android-Studio-adb-shell-无法设置为超级用户的解决方法/6.png" alt=""></li><li>到此，设置权限的问题已经解决。</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/09/13/Android-Studio-adb-shell-无法设置为超级用户的解决方法/fengmian.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="https://syydnrycx.github.io/categories/Android/"/>
    
      <category term="java" scheme="https://syydnrycx.github.io/categories/Android/java/"/>
    
    
      <category term="java" scheme="https://syydnrycx.github.io/tags/java/"/>
    
      <category term="Android" scheme="https://syydnrycx.github.io/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Visual Studio Professional 2015安装</title>
    <link href="https://syydnrycx.github.io/2018/09/04/Visual%20Studio%20Professional%202015%E5%AE%89%E8%A3%85/"/>
    <id>https://syydnrycx.github.io/2018/09/04/Visual Studio Professional 2015安装/</id>
    <published>2018-09-04T06:12:07.000Z</published>
    <updated>2018-09-10T23:05:11.929Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/09/04/Visual Studio Professional 2015安装/1.jpg" alt=""><br><a id="more"></a></p><div class="aplayer" data-id="1294899063" data-server="netease" data-type="song"></div><h1 id="Visual-Studio-Professional-2015安装"><a href="#Visual-Studio-Professional-2015安装" class="headerlink" title="Visual Studio Professional 2015安装"></a>Visual Studio Professional 2015安装</h1><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>  首先，从我的<a href="https://pan.baidu.com/s/1Kyk4bGERg21vgOxuVus3yw" target="_blank" rel="noopener">网盘</a> 密码: <code>iycx</code>，下载镜像文件。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>  将下载好的<code>.iso</code>镜像文件解压:<br><img src="/2018/09/04/Visual Studio Professional 2015安装/4.png" alt=""><br>  后双击解压的<code>.exe</code>文件，开始初始化安装:<br><img src="/2018/09/04/Visual Studio Professional 2015安装/5.png" alt=""><br>  设置要安装的<code>文件路径</code>，这里我选择了<code>D盘</code>:<br><img src="/2018/09/04/Visual Studio Professional 2015安装/6.png" alt=""><br>  接下来选择我们需要的功能，<code>根据自己的需求选择</code>:<br><img src="/2018/09/04/Visual Studio Professional 2015安装/7.png" alt=""><br><strong>【Visual C++】是可选的，如果你希望用C++开发各种类型的应用程序，需要勾选它。</strong><br><strong>【Visual F#】与【python工具】是可选的，开发Android应用程序时需要勾选。</strong><br><strong>【windows和web开发】如果你希望在VS中使用与办公软件交互的功能时需要勾选，不做阐述。</strong><br><img src="/2018/09/04/Visual Studio Professional 2015安装/8.png" alt=""><br><strong>【Windows 8.1和Windows Phone 8.0/8.1工具】不推荐勾选，使用很少</strong><br><strong>【常用工具和软件开发工具包】根据需要勾选</strong><br><img src="/2018/09/04/Visual Studio Professional 2015安装/9.png" alt=""><br>  确认自己需要的功能后点击下一步，再点击安装:<br><img src="/2018/09/04/Visual Studio Professional 2015安装/11.png" alt=""><br>  安装时间漫长，可以冲杯茶休息一下。<br>  安装完毕后，选择开发环境，这里我选择 C#:<br><img src="/2018/09/04/Visual Studio Professional 2015安装/12.png" alt=""><br>  等待环境初始化:<br><img src="/2018/09/04/Visual Studio Professional 2015安装/13.png" alt=""><br>  完成后，界面弹出:<br><img src="/2018/09/04/Visual Studio Professional 2015安装/14.png" alt=""></p><h2 id="破解"><a href="#破解" class="headerlink" title="破解"></a>破解</h2><p>  打开菜单栏的帮助，点击注册产品:<br><img src="/2018/09/04/Visual Studio Professional 2015安装/15.png" alt=""><br>  在右边栏显示试用期30天，填写秘钥: <code>HMGNV-WCYXV-X7G9W-YCX63-B98R2</code><br>  显示如下，则破解OK。<br><img src="/2018/09/04/Visual Studio Professional 2015安装/16.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/09/04/Visual Studio Professional 2015安装/1.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="软件安装" scheme="https://syydnrycx.github.io/categories/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"/>
    
    
      <category term="软件安装" scheme="https://syydnrycx.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"/>
    
  </entry>
  
  <entry>
    <title>PADS9.5安装及破解</title>
    <link href="https://syydnrycx.github.io/2018/04/21/PADS9-5%E5%AE%89%E8%A3%85%E5%8F%8A%E7%A0%B4%E8%A7%A3/"/>
    <id>https://syydnrycx.github.io/2018/04/21/PADS9-5安装及破解/</id>
    <published>2018-04-21T11:41:27.000Z</published>
    <updated>2018-04-22T03:14:24.438Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/21/PADS9-5安装及破解/success.gif" alt=""><br><a id="more"></a></p><div class="aplayer" data-id="108557" data-server="netease" data-type="song"></div><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>  好久没更新了,最近好忙好忙的,闲来无事,这一篇就说说怎样安装PADS9.5吧.</p><h1 id="PADS9-5安装"><a href="#PADS9-5安装" class="headerlink" title="PADS9.5安装"></a>PADS9.5安装</h1><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>  安装之前,可以<a href="https://pan.baidu.com/s/1IDtDAI7GI-9jcsuKvca8mA" target="_blank" rel="noopener">点击</a> 密码: <code>iycx</code>,安装相应软件及破解工具.</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>  打开下载好的目录,解压里面的’PADS_9-5.part1’和’MentorCrackMaserV2_0_1’,这里我已经解压好了,<br><img src="/2018/04/21/PADS9-5安装及破解/1.png" alt=""><br>  解压完毕后,打开PADS_9-5文件夹,找到’PADS9.5_mib’,右键属性,在兼容性中勾选以管理员身份运行此程序,<br><img src="/2018/04/21/PADS9-5安装及破解/2.png" alt=""><br>  然后我们双击运行它,<br><img src="/2018/04/21/PADS9-5安装及破解/3.png" alt=""><br><img src="/2018/04/21/PADS9-5安装及破解/4.png" alt=""><br>  在安装窗口中我们点击’next’,<br><img src="/2018/04/21/PADS9-5安装及破解/5.png" alt=""><br>  然后点击’skip’,再点击’Agree,<br><img src="/2018/04/21/PADS9-5安装及破解/6.png" alt=""><br><img src="/2018/04/21/PADS9-5安装及破解/7.png" alt=""><br>  接下来,我们先配置下需要安装的东西,这里点击’Modify’,<br><img src="/2018/04/21/PADS9-5安装及破解/8.png" alt=""><br>  选择’Product Selection’,<br><img src="/2018/04/21/PADS9-5安装及破解/9.png" alt=""><br>  这里把全部勾选,除了最后的’Server Services’不勾选,<br><img src="/2018/04/21/PADS9-5安装及破解/10.png" alt=""><br>  然后,我们选择’Target Path’,选择要安装的目录,这里我默认安装在C盘,<br><img src="/2018/04/21/PADS9-5安装及破解/11.png" alt=""><br>  在最后的一个选项’PADS Projects Path’中选择PADS工程路径,这里我也默认,选择好了安装路径后,我们点击’Done’,<br><img src="/2018/04/21/PADS9-5安装及破解/12.png" alt=""><br>  确认无误后,我们点击’Install’开始安装,<br><img src="/2018/04/21/PADS9-5安装及破解/13.png" alt=""><br><img src="/2018/04/21/PADS9-5安装及破解/14.png" alt=""><br>  等到进度条走完后,我们选择’at a later time’,先破解后,我们在打开软件.<br><img src="/2018/04/21/PADS9-5安装及破解/15.png" alt=""><br>  这个时候,桌面就有了安装好的软件.<br><img src="/2018/04/21/PADS9-5安装及破解/16.png" alt=""></p><h2 id="破解"><a href="#破解" class="headerlink" title="破解"></a>破解</h2><p>  我们打开解压’MentorCrackMaserV2_0_1’的目录,找到’MentorCrackMaster’,<br><img src="/2018/04/21/PADS9-5安装及破解/17.png" alt=""><br>  然后点击浏览,<br><img src="/2018/04/21/PADS9-5安装及破解/18.png" alt=""><br>  找到我们安装PADS的根目录,这里我刚才安装在C盘,所以C盘里直接选中该路径就可以了,如果你安装在其他盘,一样找到’MentorGraphics’这个目录,<br><img src="/2018/04/21/PADS9-5安装及破解/19.png" alt=""><br>  然后点击破戒,会弹出窗口,等待即可,<br><img src="/2018/04/21/PADS9-5安装及破解/20.png" alt=""><br>  破解成功会显示成功界面.<br><img src="/2018/04/21/PADS9-5安装及破解/21.png" alt=""> </p><h2 id="修改软件语言"><a href="#修改软件语言" class="headerlink" title="修改软件语言"></a>修改软件语言</h2><p>  我们打开Layout或者Logic其中一个软件,<br><img src="/2018/04/21/PADS9-5安装及破解/22.png" alt=""><br>  这里我的是中文界面,假设我想要英文界面,这里我们打开工具,找到’自定义’,<br><img src="/2018/04/21/PADS9-5安装及破解/23.png" alt=""><br>  在选项中,找到界面语言,修改为’English’,<br><img src="/2018/04/21/PADS9-5安装及破解/24.png" alt=""><br>  更改后会提示重启软件,<br><img src="/2018/04/21/PADS9-5安装及破解/25.png" alt=""><br>  我们关闭软件重新打开就好了,这个时候软件语言就变为英文的了,<br><img src="/2018/04/21/PADS9-5安装及破解/26.png" alt=""></p><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>  到这里,基本安装及破解都没有问题了.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/21/PADS9-5安装及破解/success.gif&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="软件安装" scheme="https://syydnrycx.github.io/categories/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"/>
    
    
      <category term="软件安装" scheme="https://syydnrycx.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"/>
    
  </entry>
  
  <entry>
    <title>MDK5环境安装与建立工程模板</title>
    <link href="https://syydnrycx.github.io/2018/04/15/MDK5%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E4%B8%8E%E5%BB%BA%E7%AB%8B%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF/"/>
    <id>https://syydnrycx.github.io/2018/04/15/MDK5环境安装与建立工程模板/</id>
    <published>2018-04-15T09:44:06.000Z</published>
    <updated>2018-04-22T03:06:39.375Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/1.jpg" alt=""><br><a id="more"></a></p><p><div class="aplayer" data-id="514761281" data-server="netease" data-type="song"></div></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>  这一篇讲怎么安装MDK5环境与stm32f103zet6工程模板的建立,包含了软件安装,st-link驱动安装与工程模板建立.</p><p>  <code>文章比较长,请细心看~</code>.</p><h1 id="MDK5环境安装"><a href="#MDK5环境安装" class="headerlink" title="MDK5环境安装"></a>MDK5环境安装</h1><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>  装软件之前,请先下载MDK5.14及相关的破解等软件.</p><p>  <a href="https://pan.baidu.com/s/1Q1BIQ_iaoGC0rlmrqbWNfw" target="_blank" rel="noopener">软件及破解软件</a> 密码: <code>iycx</code></p><p>  <a href="https://pan.baidu.com/s/1HJWEaaAKilVA0io01qya8w" target="_blank" rel="noopener">固件库安装</a>  密码: <code>iycx</code></p><p>  <strong>二个都要安装,缺一不可</strong></p><h2 id="MDK5-14安装"><a href="#MDK5-14安装" class="headerlink" title="MDK5.14安装"></a>MDK5.14安装</h2><p>  下载完软件后,就开始我们的安装,首先打开我们的软件目录,里面有<code>MDK5</code>和<code>ST LINK驱动及教程</code>.</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/2.png" alt=""></p><p>  我们先打开<code>MDK5</code>文件夹,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/3.png" alt=""></p><p>  找到<code>mdk514.exe</code>,并双击打开它,弹出安装窗口,我们点击<code>next</code>,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/4.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/5.png" alt=""></p><p>  勾选<code>I agree to all the tems of the preceding License Agreement</code> 并点击<code>next</code>,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/6.png" alt=""></p><p>  选择安装的目录,可以在D盘等其他盘,这里我不改动,直接安装在C盘,安装在其他盘时不要改动安装的文件夹,直接修改盘符就行.</p><p>  比如我安装在D盘:</p><p>  <code>请修改C:\Keil_v5 为D:\Keil_v5, 修改C:\Keil_v5\ARM\PACK为D:\Keil_v5\ARM\PACK</code></p><p>  避免不必要的麻烦.</p><p>  选择好安装目录后,我们点击<code>next</code>,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/7.png" alt=""></p><p>  在弹出来的,填写信息,这里随便填就可以了,填完点击<code>next</code></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/8.png" alt=""></p><p>  等待安装完成,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/9.png" alt=""></p><p>  进度条走完会弹出是否安装设备软件,这里点<code>安装</code>,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/10.png" alt=""></p><p>  安装完成后,取消勾选<code>Show Release Notes</code>并点击<code>Finish</code></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/11.png" alt=""></p><p>  在弹出来的窗口,关掉就可以了.</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/12.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/13.png" alt=""></p><p>  到这里软件就装好了.</p><h2 id="MDK5-14破解"><a href="#MDK5-14破解" class="headerlink" title="MDK5.14破解"></a>MDK5.14破解</h2><p>  在桌面Keil uVision5的快键方式中,右键<code>属性</code>,找到<code>兼容性</code>,勾选<code>以管理员身份运行此程序</code>,然后点击<code>确定</code>.</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/14.png" alt=""></p><p>  然后我们运行软件,在左上角<code>File</code>中找到<code>License Management..</code>,打开它.</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/15.png" alt=""></p><p>  先晾在一边冷静一下,找到我们MDK5安装包的位置,打开<code>keygen</code>文件夹,并运行keygen,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/16.png" alt=""></p><p>  我们复制keil5中的<code>CID</code>到keygan中的CID窗口里, 并选择<code>ARM</code>然后点击<code>Gemerate</code>,把生成的一段码复制到Keil5的LIC位置,点击<code>Add LIC</code>,出现了<code>Expires:Oct 2020</code>,恭喜你,程序已经破解OK了,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/17.png" alt=""></p><h2 id="MDKF1支持包安装"><a href="#MDKF1支持包安装" class="headerlink" title="MDKF1支持包安装"></a>MDKF1支持包安装</h2><p>  还是打开MDK安装包的目录,找到<code>Keil.STM32F1xx_DFP.1.0.5.pack</code>双击它,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/18.png" alt=""></p><p>  在弹出来的窗口点击<code>next</code>,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/19.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/20.png" alt=""></p><p>  安装完成后,我们点<code>Finsh</code>,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/21.png" alt=""></p><h2 id="ST-LINK驱动安装"><a href="#ST-LINK驱动安装" class="headerlink" title="ST-LINK驱动安装"></a>ST-LINK驱动安装</h2><p>  还是在刚才下载的目录中,我们找到<code>ST LINK驱动及教程\ST-LINK驱动\ST-LINK官方驱动</code>中的<code>dpinst_x86</code>与<code>dpinst_amd64</code>,</p><p>  至于装哪个,看你的电脑是几位的来装就可以了,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/22.png" alt=""></p><p>  双击打开它,并点击<code>next</code>,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/23.png" alt=""></p><p>  安装设备软件,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/24.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/25.png" alt=""></p><p>  安装完后点击<code>完成</code>.</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/26.png" alt=""></p><p>  这样ST-LINK的驱动也装好了.</p><h1 id="STM32f103ZET6工程模板建立"><a href="#STM32f103ZET6工程模板建立" class="headerlink" title="STM32f103ZET6工程模板建立"></a>STM32f103ZET6工程模板建立</h1><p>  打开下载的另一个F1固件库文件夹,先晾在一边,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/27.png" alt=""></p><p>  我们在桌面新建一个文件夹来存放工程,这里我命名<code>Project_Demo</code>,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/28.png" alt=""></p><p>  打开keil5,在上面找到<code>Project</code>-<code>New uVision Project</code>,点击它.</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/29.png" alt=""></p><p>  把它命个名保存到刚才新建的文件夹中,这里我命名为<code>Project</code>,你可以命名一个相关你项目的名字也是可以的,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/30.png" alt=""></p><p>  保存后,在弹出的窗口中我们找到我们的芯片<code>STM32F103ZE</code></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/31.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/32.png" alt=""></p><p>  点击<code>OK</code>,并关掉接下来弹出的窗口,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/33.png" alt=""></p><p>  这个时候我们可以看一下我们的工程目录中多了几个文件,这里的<code>Listings</code>和<code>Objects</code>可以删除,后面我们把生成的文件保存到另外一个文件夹了,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/34.png" alt=""></p><p>  我们在工程模板中新建几个文件夹:</p><p>  <strong>USER:存放工程文件例如main、中断等</strong><br>  <strong>STARUP:存放我们的启动文件和核心文件</strong><br>  <strong>ST_LIB:存放官方库函数</strong><br>  <strong>Output:存放我们的生成文件</strong><br>  <strong>Prj:存放项目文件</strong></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/35.png" alt=""> </p><p>  接下来,我们在ST_LIB中添加库函数文件,打开固件库目录,<code>\Libraries\STM32F10x_StdPeriph_Drive\</code>复制inc与src文件夹到ST_LIB中,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/36.png" alt=""></p><p>  添加我们的启动文件和核心文件,<code>\Libraries\CMSIS\CM3\CoreSupport</code>中的core_cm3.c和core_cm3.h到STARUP中,再找到<code>\Libraries\CMSIS\CM3\DeviceSupport\ST\startup\arm</code>中的startup_stm32f10x_hd.s到STARUP中,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/37.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/38.png" alt=""></p><p>  在定位到<code>\Libraries\CMSIS\CM3\DeviceSupport\ST</code>中复制stm32f10x.h、system_stm32f10x.c、system_stm32f10x.h到USER文件中,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/39.png" alt=""></p><p>  定位到\STM32F10x_StdPeriph_Lib_V3.5.0\Project\STM32F10x_StdPeriph_Template中,复制main.c、stm32f10x_conf.h、stm32f10x_it.c、stm32f10x_it.h到USER中,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/40.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/41.png" alt=""></p><p>  回到keil5,右键Target1,点击<code>Manage Project Items..</code>,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/42.png" alt=""></p><p>  在<code>Groups</code>栏中删除Source Group 1,添加USER、STAUP、ST_LIB、Prj,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/43.png" alt=""></p><p>  点击USER,<code>Add Files..</code>添加main.c、stm32f10x_it.c、system_stm32f10x.c,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/44.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/45.png" alt=""></p><p>  点击STAUP,<code>Add Files..</code>选择显示所以文件类型,并把core_cm3.c与startup_stm32f10x_hd.s添加进来,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/46.png" alt=""></p><p>  点击ST_LIB,<code>Add Files..</code>添加ST_LIB中src的所有文件,Ctrl+A选中所有,添加到ST_LIB,只是src文件夹里的,不包括inc里面的文件.</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/47.png" alt=""></p><p>  Prj先不添加,因为现在没有需要的项目文件需要添加,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/48.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/49.png" alt=""></p><p>  我们点击一个类似锤子的东西”魔术棒”,找到Output,<code>Select Folder for Objects</code>选中要输出编译生成文件的目录Output,最好把Create HEX file也勾上,因为如果你用串口来烧写程序,你就需要HEX文件了,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/50.png" alt=""></p><p>  点击OK,我们在打开一起魔术棒,找到C/C++,在Define栏中添加<code>STM32F10X_HD,USE_STDPERIPH_DRIVER</code>,最好复制过去,自己打错了就会引起不必要的麻烦,然后我们添加头文件,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/51.png" alt=""></p><p>  点击删除图标左边的新建,添加USER这个目录,在依次添加ST_LIB中的inc文件夹与STARUP文件夹,如图所示:</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/52.png" alt=""></p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/53.png" alt=""></p><p>  确认无误后确定,然后我们删除main.c里面的所有代码,添加:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stm32f10x.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  然后我们点击左上方的编译,</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/54.png" alt=""></p><p>  如果没有报错编译后的输出窗口应该是这样的:</p><p><img src="/2018/04/15/MDK5环境安装与建立工程模板/55.png" alt=""></p><p>  到了这里,工程模板就建立好啦,如果你写了你的项目文件,比如led.c与led.h你就可以把它放入Prj目录中,并在keil的Prj中添加.c文件,在魔术棒中的C/C++中添加led.h所在的目录.</p><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>  <code>MDK环境与安装与模板的建立就完了,如果过程中有什么问题,可以在下方留言,只要细心按步骤来,是不会有问题的!~~</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/15/MDK5环境安装与建立工程模板/1.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm32" scheme="https://syydnrycx.github.io/categories/stm32/"/>
    
      <category term="软件安装" scheme="https://syydnrycx.github.io/categories/stm32/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"/>
    
    
      <category term="stm32" scheme="https://syydnrycx.github.io/tags/stm32/"/>
    
      <category term="软件安装" scheme="https://syydnrycx.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"/>
    
  </entry>
  
  <entry>
    <title>stm8学习笔记-串口</title>
    <link href="https://syydnrycx.github.io/2018/04/15/stm8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%B2%E5%8F%A3/"/>
    <id>https://syydnrycx.github.io/2018/04/15/stm8学习笔记-串口/</id>
    <published>2018-04-15T05:04:22.000Z</published>
    <updated>2018-04-15T05:41:58.266Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/15/stm8学习笔记-串口/1.jpg" alt=""><br><a id="more"></a></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>  在单片机中,串口是我们很多项目中离不开的功能,它可以帮助我们调试程序,打印信息,用两根线就可以实现收与发,所以这一篇,我们介绍一下串口的配置.</p><h1 id="串口配置"><a href="#串口配置" class="headerlink" title="串口配置"></a>串口配置</h1><p>  配置串口前,要先说的是我配置的是串口3,并且用的是寄存器的方式配置的,所以在配置中有什么不理解的最好查手册</p><p><img src="/2018/04/15/stm8学习笔记-串口/2.png" alt=""></p><p>  首先,我们在.h中定义初始化函数<code>uart3_init(u32 bound)</code>, bound是要初始化的波特率.</p><p>  然后我们看一下寄存器的配置:</p><p><img src="/2018/04/15/stm8学习笔记-串口/3.png" alt=""></p><p><img src="/2018/04/15/stm8学习笔记-串口/4.png" alt=""></p><p><img src="/2018/04/15/stm8学习笔记-串口/5.png" alt=""></p><p>  根据上面框起来的来配置寄存器,最后在通过<code>UART-&gt;BBR2与UART-&gt;BBR1</code>来写入波特率,后开启UART就可以了</p><p>  具体的我们看下面程序.</p><h1 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">uart3.h</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __UART3_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>__UART3_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stm8s.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HSIClockFreq 16000000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UART3_FLAG_TXE  (uint8_t)0x80 <span class="comment">//发送数据寄存器空标志 </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UART3_FLAG_RXNE (uint8_t)0x20 <span class="comment">//读取数据寄存器非空标志</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> U3RxBufferSize 64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> u8 USART3_RX_BUF[U3RxBufferSize]; </span><br><span class="line"><span class="keyword">extern</span> u8 USART3_TX_BUF[U3RxBufferSize];</span><br><span class="line"><span class="keyword">extern</span> u8 USART3_RX_STA; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">uart3_init</span><span class="params">(u32 bound)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UART3_SendByte</span><span class="params">(u8 data)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UART3_SendString</span><span class="params">(u8* str)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">u3_printf</span><span class="params">(<span class="keyword">char</span>* fmt,...)</span></span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">uart3.c</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"uart3.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdarg.h"</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"string.h"</span></span></span><br><span class="line"></span><br><span class="line">u8 USART3_TX_BUF[U3RxBufferSize];</span><br><span class="line">u8 USART3_RX_BUF[U3RxBufferSize];     <span class="comment">//接收缓冲,最大USART_REC_LEN个字节.</span></span><br><span class="line"><span class="comment">//接收状态</span></span><br><span class="line"><span class="comment">//bit15，接收完成标志</span></span><br><span class="line"><span class="comment">//bit14，接收到0x0d</span></span><br><span class="line"><span class="comment">//bit13~0，接收到的有效字节数目</span></span><br><span class="line">u8 USART3_RX_STA=<span class="number">0</span>;       <span class="comment">//接收状态标记</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">uart3_init</span><span class="params">(u32 bound)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//1位起始位 8位数据位 结束位由CR3设置 不使用奇偶校验 不使能奇偶校验中断</span></span><br><span class="line">  UART3-&gt;CR1 &amp;= <span class="number">0xE0</span>;</span><br><span class="line">  <span class="comment">//禁止发送中断和空闲中断， 使能发送和接收  使能接收中断</span></span><br><span class="line">  UART3-&gt;CR2 = (<span class="number">0</span>&lt;&lt;<span class="number">7</span>)|(<span class="number">0</span>&lt;&lt;<span class="number">6</span>)|(<span class="number">1</span>&lt;&lt;<span class="number">5</span>)|(<span class="number">0</span>&lt;&lt;<span class="number">4</span>)|(<span class="number">1</span>&lt;&lt;<span class="number">3</span>)|(<span class="number">1</span>&lt;&lt;<span class="number">2</span>);</span><br><span class="line">  <span class="comment">//禁止LIN模式， 设置1位停止位 不使能CLK时钟</span></span><br><span class="line">  UART3-&gt;CR3 &amp;= <span class="number">0x07</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*设置波特率*/</span></span><br><span class="line">  bound =HSIClockFreq/bound;  <span class="comment">/*求出分频因子*/</span></span><br><span class="line">  UART3-&gt;BRR2 = bound &amp; <span class="number">0x0f</span>;</span><br><span class="line">  UART3-&gt;BRR2 |= ((bound &amp; <span class="number">0xf000</span>) &gt;&gt; <span class="number">8</span>);</span><br><span class="line">  UART3-&gt;BRR1 = ((bound &amp; <span class="number">0x0ff0</span>) &gt;&gt; <span class="number">4</span>);    <span class="comment">/*先给BRR2赋值 最后再设置BRR1*/</span></span><br><span class="line">  </span><br><span class="line">  UART3-&gt;CR1 |= (<span class="number">0</span>&lt;&lt;<span class="number">5</span>);         <span class="comment">/*使能UART*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函数名称：void UART3_SendByte(u8 byte)</span></span><br><span class="line"><span class="comment">函数功能：串口发送单字节函数</span></span><br><span class="line"><span class="comment">入口参数：byte-待发送字节数据</span></span><br><span class="line"><span class="comment">返回值：  无</span></span><br><span class="line"><span class="comment">说明  ：  </span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UART3_SendByte</span><span class="params">(u8 byte)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  UART3-&gt;DR=byte;</span><br><span class="line">  <span class="keyword">while</span> (!(UART3-&gt;SR &amp; <span class="number">0x80</span>));<span class="comment">//等待发送完成</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函数名称：void UART3_SendString(u8* str)</span></span><br><span class="line"><span class="comment">函数功能：串口发送字符串函数</span></span><br><span class="line"><span class="comment">入口参数：str-待发送字符串</span></span><br><span class="line"><span class="comment">返回值：  无</span></span><br><span class="line"><span class="comment">说明  ：  无   </span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UART3_SendString</span><span class="params">(u8* str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (*str != <span class="string">'\0'</span>)</span><br><span class="line">  &#123;</span><br><span class="line">      UART3_SendByte(*str);</span><br><span class="line">      str++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">u3_printf</span><span class="params">(<span class="keyword">char</span>* fmt,...)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">u16 i,j; </span><br><span class="line">va_list ap; </span><br><span class="line">va_start(ap,fmt);</span><br><span class="line"><span class="built_in">vsprintf</span>((<span class="keyword">char</span>*)USART3_TX_BUF,fmt,ap);</span><br><span class="line">va_end(ap);</span><br><span class="line">i=<span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span>*)USART3_TX_BUF);<span class="comment">//此次发送数据的长度</span></span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;i;j++)<span class="comment">//循环发送数据</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span>(UART3_GetFlagStatus(UART3_FLAG_TC) ==RESET); <span class="comment">//循环发送,直到发送完毕   </span></span><br><span class="line">      UART3_SendData8(USART3_TX_BUF[j]); </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>到了这一步,串口就基本OK了,但是我们还需要接受,这里就需要中断函数了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">INTERRUPT_HANDLER(UART3_RX_IRQHandler, <span class="number">21</span>)</span><br><span class="line">&#123;</span><br><span class="line">  u8 res;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (UART3-&gt;SR &amp; UART3_FLAG_RXNE)<span class="comment">//接收中断(接收到的数据必须是0x0d 0x0a结尾)</span></span><br><span class="line">  &#123;</span><br><span class="line">    res = (u8)UART3-&gt;DR;<span class="comment">//读取接收到的数据</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ((USART3_RX_STA &amp; <span class="number">0x80</span>) == <span class="number">0</span>)<span class="comment">//接收未完成</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (USART3_RX_STA &amp; <span class="number">0x40</span>)<span class="comment">//接收到了0x0d</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> (res != <span class="number">0x0A</span>)<span class="comment">//接收错误,重新开始</span></span><br><span class="line">        &#123;</span><br><span class="line">          USART3_RX_STA = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span><span class="comment">//接收完成 </span></span><br><span class="line">        &#123;</span><br><span class="line">          USART3_RX_STA|= <span class="number">0x80</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span><span class="comment">//还没收到0X0D</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">0x0D</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          USART3_RX_STA|= <span class="number">0x40</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          USART3_RX_BUF[USART3_RX_STA&amp;<span class="number">0x3F</span>] = res;</span><br><span class="line">          USART3_RX_STA++;</span><br><span class="line">          <span class="keyword">if</span> (USART3_RX_STA &gt; U3RxBufferSize<span class="number">-1</span>)<span class="comment">//接收数据错误,重新开始接收</span></span><br><span class="line">          &#123;</span><br><span class="line">            USART3_RX_STA = <span class="number">0</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/15/stm8学习笔记-串口/1.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm8" scheme="https://syydnrycx.github.io/categories/stm8/"/>
    
    
      <category term="stm8" scheme="https://syydnrycx.github.io/tags/stm8/"/>
    
  </entry>
  
  <entry>
    <title>stm8学习笔记-定时器</title>
    <link href="https://syydnrycx.github.io/2018/04/15/stm8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%AE%9A%E6%97%B6%E5%99%A8/"/>
    <id>https://syydnrycx.github.io/2018/04/15/stm8学习笔记-定时器/</id>
    <published>2018-04-15T01:20:32.000Z</published>
    <updated>2018-04-15T01:31:38.306Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/15/stm8学习笔记-定时器/1.jpg" alt=""><br><a id="more"></a></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>  这一篇,大概说一下定时器的配置,定时器在我们实际运用中,非常重要,一个定时器可以做很多的工作,所以,这一篇就讲一下如何配置。</p><h1 id="定时器配置"><a href="#定时器配置" class="headerlink" title="定时器配置"></a>定时器配置</h1><p>  定时器配置很简单，首先我们需要添加库函数，这里我配置的是定时器1，所以<code>添加stm8s_tim1.c与.h文件</code>,然后我们要<code>配置TIM1_TimeBaseInit这个函数</code>.</p><p><img src="/2018/04/15/stm8学习笔记-定时器/2.png" alt=""></p><p>  这个函数有4个入口参数,<br>  <code>TIM1_Prescaler是设置定时器的预分频值,  TIM1_CounterMode是设置定时器的计数模式，  TIM1_Period是设置定时器的自动重装载值，  TIM1_RepetitionCounter是定时器的重复计数值;</code></p><p>  <strong>定时的时长取决于：设置的时钟频率÷预分频值÷自动重装载值；</strong></p><p>  这里我设置的时钟频率是16M高速时钟，16分频，1000的自动重装载值，所以16M/16/1000 = 1KHz = 1ms;</p><p>  然后我们需要使能自动预装载与中断，它们分别是：</p><p><img src="/2018/04/15/stm8学习笔记-定时器/3.png" alt=""></p><p><img src="/2018/04/15/stm8学习笔记-定时器/4.png" alt=""></p><p>  最后我们使能定时器就可以了:</p><p><img src="/2018/04/15/stm8学习笔记-定时器/5.png" alt=""></p><p>  具体怎样配置定时器就说到这里，接下来看程序.</p><h1 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">timer.c</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @文件名 timer.c</span></span><br><span class="line"><span class="comment">  * @作者    ycx</span></span><br><span class="line"><span class="comment">  * @版本号V1.0.0</span></span><br><span class="line"><span class="comment">  * @日期   09/01/2018</span></span><br><span class="line"><span class="comment">  * @功能   </span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">/* includes  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"timer.h"</span></span></span><br><span class="line"><span class="comment">/* function  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TIMER1_Init</span><span class="params">(u16 psc, u16 arr, u8 count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  TIM1_TimeBaseInit(psc, TIM1_COUNTERMODE_UP, arr, count);</span><br><span class="line">  TIM1_ARRPreloadConfig(ENABLE);<span class="comment">//使能自动重装</span></span><br><span class="line">  TIM1_ITConfig(TIM1_IT_UPDATE , ENABLE);<span class="comment">//数据更新中断</span></span><br><span class="line">  TIM1_Cmd(ENABLE);<span class="comment">//开定时器</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">timer.h</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @文件名 timer.h</span></span><br><span class="line"><span class="comment">  * @作者    ycx</span></span><br><span class="line"><span class="comment">  * @版本号V1.0.0</span></span><br><span class="line"><span class="comment">  * @日期   09/01/2018</span></span><br><span class="line"><span class="comment">  * @功能   </span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">/* includes  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __TIMER_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __TIMER_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stm8s.h"</span></span></span><br><span class="line"><span class="comment">/* function  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TIMER1_Init</span><span class="params">(u16 psc, u16 arr, u8 count)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">main.c</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @文件名 main.c</span></span><br><span class="line"><span class="comment">  * @作者  ycx</span></span><br><span class="line"><span class="comment">  * @版本号V1.0.0</span></span><br><span class="line"><span class="comment">  * @日期   05/01/2018</span></span><br><span class="line"><span class="comment">  * @功能   定时器1</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">/* includes  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stm8s.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"led.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"delay.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"clk.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"key.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"timer.h"</span></span></span><br><span class="line"><span class="comment">/* typedef   ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* define    ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* variables ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* constants ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* function  ------------------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*设置内部高速时钟16M为主时钟*/</span> </span><br><span class="line">  CLK_Config(CLK_PRESCALER_HSIDIV1);</span><br><span class="line">  TIMER1_Init(<span class="number">16</span>, <span class="number">1000</span>, <span class="number">0</span>);<span class="comment">//(16M/16)/1000 = 1kHz = 1ms</span></span><br><span class="line">  LED_Init();</span><br><span class="line">  Key_Init();</span><br><span class="line">  delay_init(<span class="number">16</span>);</span><br><span class="line">  __enable_interrupt(); </span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <code>主函数什么都没有放，是因为我把需要实现的功能放在了定时器的中断里</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stm8s_it.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"timer.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"led.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"key.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">volatile</span> u16 tim_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">INTERRUPT_HANDLER(TIM1_UPD_OVF_TRG_BRK_IRQHandler, <span class="number">11</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* In order to detect unexpected events during development,</span></span><br><span class="line"><span class="comment">     it is recommended to set a breakpoint on the following instruction.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  u8 key;</span><br><span class="line">  tim_count++;</span><br><span class="line">  <span class="keyword">if</span> (tim_count == <span class="number">1000</span>)   <span class="comment">//每1S灯的状态翻转一次</span></span><br><span class="line">  &#123;</span><br><span class="line">    LED1 = ~LED1;</span><br><span class="line">    LED2 = ~LED2;</span><br><span class="line">    LED3 = ~LED3;</span><br><span class="line">    tim_count = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  TIM1-&gt;SR1 &amp;= <span class="number">0</span>&lt;&lt;<span class="number">0</span>; <span class="comment">//清除中断标志</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>  stm8定时器相对于stm32来说配置起来简单了许多,所以应该不会特别难理解,多用就会了.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/15/stm8学习笔记-定时器/1.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm8" scheme="https://syydnrycx.github.io/categories/stm8/"/>
    
    
      <category term="stm8" scheme="https://syydnrycx.github.io/tags/stm8/"/>
    
  </entry>
  
  <entry>
    <title>stm8学习笔记-LED</title>
    <link href="https://syydnrycx.github.io/2018/04/14/stm8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-LED/"/>
    <id>https://syydnrycx.github.io/2018/04/14/stm8学习笔记-LED/</id>
    <published>2018-04-14T08:33:44.000Z</published>
    <updated>2018-04-14T08:39:41.627Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/14/stm8学习笔记-LED/1.jpg" alt=""><br><a id="more"></a></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>  这是之前博客发过的东西了,现在重新上传上来而已.</p><h1 id="LED配置"><a href="#LED配置" class="headerlink" title="LED配置"></a>LED配置</h1><p><img src="/2018/04/14/stm8学习笔记-LED/2.png" alt=""></p><p>  这是我买的stm8s103F3的最小系统板灯上的原理图，从原理图可以看到，当拉高PB5时，LED灭，拉低PB5时，LED亮，所以我们需要配置PB5端口为输出，通过控制端口输出电平来控制灯的亮灭</p><p>  接下来我们讲一下如何配置：</p><p>  因为我最小系统板上的LED灯是在PB5 所以我们配置PB5为推挽输出,10MHz</p><p><img src="/2018/04/14/stm8学习笔记-LED/3.png" alt=""></p><p><img src="/2018/04/14/stm8学习笔记-LED/4.png" alt=""></p><p><img src="/2018/04/14/stm8学习笔记-LED/5.png" alt=""></p><p>  配置完后，我们拉高或拉低需要借助输出寄存器ODR</p><p><img src="/2018/04/14/stm8学习笔记-LED/6.png" alt=""></p><p>  通过对位5写1或者写0来拉高拉低,基本配置就这些，接下来看程序</p><h1 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">led.c</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @文件名 led.c</span></span><br><span class="line"><span class="comment">  * @作者   ycx</span></span><br><span class="line"><span class="comment">  * @版本号V1.0.0</span></span><br><span class="line"><span class="comment">  * @日期   06/01/2018</span></span><br><span class="line"><span class="comment">  * @功能   </span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">/* includes  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"led.h"</span></span></span><br><span class="line"><span class="comment">/* function  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函数名称：void LED_Init(void)</span></span><br><span class="line"><span class="comment">函数功能：LED初始化</span></span><br><span class="line"><span class="comment">入口参数：无</span></span><br><span class="line"><span class="comment">返回值：  无</span></span><br><span class="line"><span class="comment">说明  ：  </span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LED_Init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  PB_DDR |= <span class="number">1</span>&lt;&lt;<span class="number">5</span>;<span class="comment">//设置为输出</span></span><br><span class="line">  PB_CR1 |= <span class="number">1</span>&lt;&lt;<span class="number">5</span>;<span class="comment">//推挽输出</span></span><br><span class="line">  PB_CR2 |= <span class="number">1</span>&lt;&lt;<span class="number">5</span>;<span class="comment">//10Mhz</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">led.h</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @文件名 led.h</span></span><br><span class="line"><span class="comment">  * @作者   ycx</span></span><br><span class="line"><span class="comment">  * @版本号V1.0.0</span></span><br><span class="line"><span class="comment">  * @日期   06/01/2018</span></span><br><span class="line"><span class="comment">  * @功能   </span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">/* includes  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __LED_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __LED_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stm8.h"</span></span></span><br><span class="line"><span class="comment">/* define    ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LED_ON PB_ODR&amp;=0&lt;&lt;5     <span class="comment">//这里用宏定义的方式来拉高拉低LED</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LEDOFF PB_ODR|=1&lt;&lt;5</span></span><br><span class="line"><span class="comment">/* function  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LED_Init</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">main.c</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @文件名 main.c</span></span><br><span class="line"><span class="comment">  * @作者   ycx</span></span><br><span class="line"><span class="comment">  * @版本号V1.0.0</span></span><br><span class="line"><span class="comment">  * @日期   06/01/2018</span></span><br><span class="line"><span class="comment">  * @功能   LED</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">/* includes  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stm8.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"led.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"clk.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"delay.h"</span></span></span><br><span class="line"><span class="comment">/* typedef   ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* define    ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* variables ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* function  ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* constants ------------------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  CLK_Init();</span><br><span class="line">  LED_Init();</span><br><span class="line">  delay_init(<span class="number">16</span>);<span class="comment">//延时由于刚接触stm8所以用的死等的方式</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    LED_ON;</span><br><span class="line">    delay_ms(<span class="number">200</span>);</span><br><span class="line">    LEDOFF;</span><br><span class="line">    delay_ms(<span class="number">200</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  这样一个LED灯就亮起来了</p><p><img src="/2018/04/14/stm8学习笔记-LED/7.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/14/stm8学习笔记-LED/1.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm8" scheme="https://syydnrycx.github.io/categories/stm8/"/>
    
    
      <category term="stm8" scheme="https://syydnrycx.github.io/tags/stm8/"/>
    
  </entry>
  
  <entry>
    <title>Java开发环境安装及环境变量配置</title>
    <link href="https://syydnrycx.github.io/2018/04/13/Java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE/"/>
    <id>https://syydnrycx.github.io/2018/04/13/Java开发环境安装及环境变量配置/</id>
    <published>2018-04-13T04:51:34.000Z</published>
    <updated>2018-04-22T03:15:52.496Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/post.jpg" alt=""><br><a id="more"></a></p><p><div class="aplayer" data-id="461899833" data-server="netease" data-type="song"></div></p><p>#前言<br>  最近,开始教Java,发现很多人安装了Java后出现了各种问题,这里就对Java安装步骤及环境变量配置作详细的介绍.</p><h1 id="安装Java开发环境"><a href="#安装Java开发环境" class="headerlink" title="安装Java开发环境"></a>安装Java开发环境</h1><h2 id="JDK下载"><a href="#JDK下载" class="headerlink" title="JDK下载"></a>JDK下载</h2><p>  首先,打开下载网站：<a href="http://www.oracle.com/" target="_blank" rel="noopener">www.oracle.com</a>,根据箭头方向找到Java SE,</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/1.png" alt=""></p><p>  进入页面后,在下方找到<code>Download Java SE for Developers</code>,并打开它</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/2.png" alt=""></p><p>  打开后页面是这样的:</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/3.png" alt=""></p><p>  这里要提醒一下,最好不要装Java最新的版本,因为新版本中环境变量和旧的不同,而且新版本配置后部分人反映配置后不能使用.</p><p>  所以这里我们向下找到<code>Java SE 8u161/ 8u162</code>,并点击JDK下面的DOWNLOAD,</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/4.png" alt=""></p><p>  这里我选择的是Java SE Development Kit 8u162,选择适合你电脑的位,这里我的是64位,所以下载了64位的安装包.</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/5.png" alt=""></p><h2 id="JDK安装"><a href="#JDK安装" class="headerlink" title="JDK安装"></a>JDK安装</h2><p>  根据上面的步骤,我们下载好了JDK的安装包后,我们打开安装包,后点击下一步进行安装,</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/6.png" alt=""> </p><p>  这里要注意的是：<code>最好不要更改安装目录,因为部分安装到别的目录不会配置环境变量,所以为了不必要的麻烦,尽量不要更改安装目录</code>.</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/7.png" alt=""> </p><p>  点击”下一步”后,程序就开始安装了,JDK安装完成后,会提示你是否安装JRE,同样的,我们不修改安装目录,直接下一步开始安装就行了</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/8.png" alt=""> </p><p>  安装完成后,我们点击关闭就可以了.</p><p>  到这里,你的Java开发环境算是安装成功了.接下来我们说一下如何配置JDK环境变量.</p><h1 id="JDK环境变量配置"><a href="#JDK环境变量配置" class="headerlink" title="JDK环境变量配置"></a>JDK环境变量配置</h1><p>  在资源管理器中,右击我的电脑,选择属性,在弹出来的系统面板中选择高级系统属性,</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/9.png" alt=""></p><p>  在弹出来的系统属性中,我们打开环境变量.</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/10.png" alt=""></p><p>  这里我们在系统变量中添加</p><p>变量名: <strong>JAVA_HOME</strong><br>变量值: <strong>C:\Program Files\Java\jdk1.8.0_162</strong></p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/11.png" alt=""></p><p>  接下来,在系统变量中寻找”Path”变量,如果不存在,则新建变量”Path”,如果存在,则选中编辑它.</p><p>  在变量值最前面,添加:</p><p><strong>%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;</strong></p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/12.png" alt=""></p><p>  添加完后,确认,在系统变量中寻找”CLASSPATH”,和上面一样,如果存在则编辑,不存在则新建,</p><p>变量名: <strong>CLASSPATH</strong><br>变量值: <strong>%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;</strong></p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/13.png" alt="">  </p><p>  全部添加好后,我们点击确定,回到桌面,win+R输入cmd,打开cmd命令窗口,</p><p>输入以下命令:</p><p>`<br>java -version</p><p>javac -version</p><p>set JAVA_HOME<br>`</p><p>输出窗口如下信息,即为配置成功:</p><p><img src="/2018/04/13/Java开发环境安装及环境变量配置/14.png" alt="">  </p><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p> <code>配置环境变量最重要的是细心,如果少一个标点符号都有可能导致后面验证窗口信息失败,所以请准确的安装步骤来配置.</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/13/Java开发环境安装及环境变量配置/post.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="java" scheme="https://syydnrycx.github.io/categories/java/"/>
    
    
      <category term="java" scheme="https://syydnrycx.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>stm32AD采样滤波之中位值平均滤波</title>
    <link href="https://syydnrycx.github.io/2018/04/13/stm32AD%E9%87%87%E6%A0%B7%E6%BB%A4%E6%B3%A2%E4%B9%8B%E4%B8%AD%E4%BD%8D%E5%80%BC%E5%B9%B3%E5%9D%87%E6%BB%A4%E6%B3%A2/"/>
    <id>https://syydnrycx.github.io/2018/04/13/stm32AD采样滤波之中位值平均滤波/</id>
    <published>2018-04-13T04:30:13.000Z</published>
    <updated>2018-04-13T04:43:31.400Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/13/stm32AD采样滤波之中位值平均滤波/post.png" alt=""><br><a id="more"></a></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>  水温中,我们说到了为了防止AD波动使得送入表中查到的温度上下跳动,那么怎么坐到防止AD波动大呢,这就需要我们的滤波算法了.</p><p>  相信很多初学者,一开始学习ADC时,都是用的均值滤波，取十次值求平均,这种滤波方式如果AD跳动略快就会不精准,所以这里我提供了另一种滤波的方式.</p><h1 id="滤波算法"><a href="#滤波算法" class="headerlink" title="滤波算法"></a>滤波算法</h1><h2 id="滤波讲解"><a href="#滤波讲解" class="headerlink" title="滤波讲解"></a>滤波讲解</h2><p>  <code>先对AD取N次值(N为奇数),对AD采样值进行排序,然后去掉一个最大与一个最小，计算N-2个数据的算术平均值，这个值作为本次AD的实际采样值</code></p><p>  这个方法结合了普通均值滤波的优点,又在它的基础上提高了精度，通过排序去掉了最小与最大,但是在提高的精度的前提,<code>是十分浪费CPU的</code>.</p><p>  不过这对于stm32资源丰富的芯片来说,这个滤波方法不失为一个提升AD精度的方式.</p><h2 id="滤波算法-1"><a href="#滤波算法-1" class="headerlink" title="滤波算法"></a>滤波算法</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 13</span></span><br><span class="line"></span><br><span class="line"><span class="function">u16 <span class="title">Get_Adc_Average</span><span class="params">(u8 ch)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    u16 value_buf[N];</span><br><span class="line">u16 temp;</span><br><span class="line">u8 count, i, j;</span><br><span class="line"><span class="keyword">for</span> (count=<span class="number">0</span>; count&lt;N; count++)</span><br><span class="line">&#123;</span><br><span class="line">value_buf[count] = Get_Adc(ch);</span><br><span class="line">delay_ms(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (j=<span class="number">0</span>; j&lt;N<span class="number">-1</span>; j++)<span class="comment">//冒泡排序</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;N-j<span class="number">-1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (value_buf[i] &gt; value_buf[i+<span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line">temp = value_buf[i];</span><br><span class="line">value_buf[i] = value_buf[i+<span class="number">1</span>];</span><br><span class="line">value_buf[i+<span class="number">1</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (count=<span class="number">1</span>; count&lt;N<span class="number">-1</span>; count++)</span><br><span class="line">&#123;</span><br><span class="line">temp += value_buf[count];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> temp/(N<span class="number">-2</span>);<span class="comment">//把N次采样值按大小排列 ，取中间值为本次有效值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>  <code>滤波算法有很多种,这只是其中的一种,不同的滤波方式适用与不同的环境,所以怎么选择一个滤波方式,还是要根据使用的实际情况.</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/13/stm32AD采样滤波之中位值平均滤波/post.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm32" scheme="https://syydnrycx.github.io/categories/stm32/"/>
    
    
      <category term="stm32" scheme="https://syydnrycx.github.io/tags/stm32/"/>
    
  </entry>
  
  <entry>
    <title>stm32f030水温控制(完)</title>
    <link href="https://syydnrycx.github.io/2018/04/13/stm32f030%E6%B0%B4%E6%B8%A9%E6%8E%A7%E5%88%B6-%E5%AE%8C/"/>
    <id>https://syydnrycx.github.io/2018/04/13/stm32f030水温控制-完/</id>
    <published>2018-04-13T03:12:40.000Z</published>
    <updated>2018-04-22T03:05:53.425Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/13/stm32f030水温控制-完/po.png" alt=""></p><a id="more"></a><p><div class="aplayer" data-id="472117541" data-server="netease" data-type="song"></div></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>  前面的子模块的基本配置已经讲过了,这一篇算是完结篇了,本篇只讲大致如何实现各模块组合实现水温控制,程序子模块都已经有了,剩下的只是把子模块整合在一起,实现一个具体的功能.</p><h1 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h1><h2 id="程序框架"><a href="#程序框架" class="headerlink" title="程序框架"></a>程序框架</h2><p>  首先你得确保你的子模块单独运行时没有错误,可以实现单独的功能,如果连基本的独立工作的功能都无法实现,整合就谈不上了.</p><p><img src="/2018/04/13/stm32f030水温控制-完/po-1.png" alt=""></p><h2 id="框架讲解"><a href="#框架讲解" class="headerlink" title="框架讲解"></a>框架讲解</h2><h2 id="再次提醒一下-一定要确保你每个子模块都能独立运行"><a href="#再次提醒一下-一定要确保你每个子模块都能独立运行" class="headerlink" title="  再次提醒一下,一定要确保你每个子模块都能独立运行"></a>  <code>再次提醒一下,一定要确保你每个子模块都能独立运行</code></h2><ol><li>确保你的系统能有一个1s翻转1次的LED指示灯(确保程序在运行)</li><li>通过定义变量获取AD值,输入滤波算法得到滤波后的AD值(确保精准)</li><li>滤波后的AD最好尽量精准平稳,因为可以确保查表后温度跳动不会特别明显.</li><li>EC11确认能通过左旋右旋控制设定的温度值,并且要保证EC11按键精准可控,并且将设定的温度与实际温度分别显示在数码管中.</li><li>将获取的实际温度与设定温度传入pid算法,并且通过pid参数整定不断调整到系统最佳.</li><li>将Pid的输出通过改变PWM实现控温效果.</li></ol><h2 id="时间要求"><a href="#时间要求" class="headerlink" title="时间要求"></a>时间要求</h2><hr><p> 1.LED – 1S翻转(有两个指示灯,建议一个用来做系统运行指示灯,另一个调试用)<br> 2.AD采集 – 10ms-50ms采集一次.</p><ol start="3"><li>查表获取温度 – 30-60ms查一次表(使得数码管显示的实际温度不会跳变太快)</li><li>对实际温度与设定温度进行运算送入数码管 – 300ms(同上,使得数码管跳变不会太快)</li><li>数码管动态扫描 – 0.01ms扫描一次(确保数码管不会亮度太暗,或者人眼可以看见跳动)</li><li>pid运算 – 建议直接放在while(反馈系统一直在线)</li></ol><h2 id="模块整合"><a href="#模块整合" class="headerlink" title="模块整合"></a>模块整合</h2><p>  建议通过上述框架一点点加入子模块,确保每次加入子模块后程序还能继续运行.</p><p>  通过程序框图,与每个模块执行认为的时间,基本可以实现控温,这里需要提醒的是,最好不要阻塞程序运行,否则效率会低.</p><p>  模块整合这边不会贴出代码,只给出了思路,至于怎么整合,只要稍微有C语言的基础,都能对程序逻辑做出很好的实现,程序子模块都确保可以运行,剩下的基本就是逻辑方面上的问题了.</p><h1 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h1><p>  实际效果可参考：<br>  <a href="http://v.youku.com/v_show/id_XMzUyODI5ODQwNA==.html?spm=a2h0j.11185381.0.0" target="_blank" rel="noopener">点击这儿</a><br>  <a href="http://v.youku.com/v_show/id_XMzUyODAxMjgxMg==.html?spm=a2hzp.8244740.0.0" target="_blank" rel="noopener">点击这儿</a></p><p>  这里误差大概 -1 到 +1度之间.</p><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><p>  上面视频里,温度跳动稍微有些快,后来做了修改:<br> 1.之前是10ms采集AD,后来修正为500ms采一次AD.<br> 2.PID参数微调.</p><p>比上面效果会更好,但是没法上传.</p><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>  看到这里,水温控制已经完结了,如果你有什么疑问可以评论问我,我看到会尽量回复的.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/13/stm32f030水温控制-完/po.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm32" scheme="https://syydnrycx.github.io/categories/stm32/"/>
    
    
      <category term="stm32" scheme="https://syydnrycx.github.io/tags/stm32/"/>
    
  </entry>
  
  <entry>
    <title>基于stm32f030水温控制5</title>
    <link href="https://syydnrycx.github.io/2018/04/13/%E5%9F%BA%E4%BA%8Estm32f030%E6%B0%B4%E6%B8%A9%E6%8E%A7%E5%88%B65/"/>
    <id>https://syydnrycx.github.io/2018/04/13/基于stm32f030水温控制5/</id>
    <published>2018-04-13T02:59:11.000Z</published>
    <updated>2018-04-13T03:04:50.411Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/13/基于stm32f030水温控制5/po-1-5.png" alt=""></p><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>  到这里,子模块已经写了4篇了,这一篇就对最为核心的pid做完介绍就开始简单讲模块整合了.</p><p>  pid分许多种,位置式pid、增量式pid、积分分离pid、抗积分饱和性pid、梯形积分pid、模糊Pid等等.</p><p>  P是比例,I是积分,D是微分.就我的理解,它是一个自动控制系统,我们核心的就是pid参数的整定,至于pid究竟是个什么东西.网上有一大把讲的比我透彻的资料,这里我就不献丑了.</p><h1 id="PID"><a href="#PID" class="headerlink" title="PID"></a>PID</h1><h2 id="pid算法的选择"><a href="#pid算法的选择" class="headerlink" title="pid算法的选择"></a>pid算法的选择</h2><p>  我大概用了C语音打印出来的表,从图里看位置型,上升的斜率比较平缓,适合水温上升的幅度,增量式的和位置式的接近,这里我没贴出图,所以我用的是位置式pid<br>至于位置式和增量式如何选择,我是不知道从哪里看到的资料,说位置式适用于没有记忆性器件的环境,而增量式相反,而水温加热这边我只是控制固态继电器开关,没有记忆性的环境,所以我选择的是位置式Pid,并不是说只有位置式可以达到要求,增量式其实也是可以的<br>至于如何选择,还需根据自己的实际情况来决定.</p><p><img src="/2018/04/13/基于stm32f030水温控制5/po-4-1.png" alt=""></p><p><img src="/2018/04/13/基于stm32f030水温控制5/po-4-2.png" alt=""></p><p><img src="/2018/04/13/基于stm32f030水温控制5/po-4-3.png" alt=""></p><h2 id="pid实现"><a href="#pid实现" class="headerlink" title="pid实现"></a>pid实现</h2><p>  首先,我们定义一个pid的结构体,并声明它.</p><p><img src="/2018/04/13/基于stm32f030水温控制5/po-4-4.png" alt=""></p><p>  接下来,我们设置个函数初始化这些参数,</p><p><img src="/2018/04/13/基于stm32f030水温控制5/po-4-5.png" alt=""></p><p>  初始化好了后,就是我们的核心算法了,<br><img src="/2018/04/13/基于stm32f030水温控制5/po-4-6.png" alt=""></p><h2 id="pid参数整定"><a href="#pid参数整定" class="headerlink" title="pid参数整定"></a>pid参数整定</h2><p>  老实说我也不太会,调整参数这边,我的建议是先不加入积分与微分,仅加入比例控制,直到系统可以到达你所设置温度,接下来过冲,振荡建议用串口打印后生成表格来调整积分与比例.</p><p>  参数整定这边,我能给出的建议就这些,毕竟我也是初学Pid.</p><p>  这里给出常用的口诀:<br><code>参数整定找最佳，从小到大顺序查先是比例后积分，最后再把微分加曲线振荡很频繁，比例度盘要放大曲线漂浮绕大湾，比例度盘往小扳曲线偏离回复慢，积分时间往下降曲线波动周期长，积分时间再加长曲线振荡频率快，先把微分降下来动差大来波动慢。微分时间应加长理想曲线两个波，前高后低四比一一看二调多分析，调节质量不会低</code></p><h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><p>忘了说了,我的是NTC采集的温度,所以需要配置AD采集与对NTC温度表对应.</p><p>这里给出ADC配置</p><p><img src="/2018/04/13/基于stm32f030水温控制5/po-4-7.png" alt=""></p><p><img src="/2018/04/13/基于stm32f030水温控制5/po-4-8.png" alt=""></p><p><img src="/2018/04/13/基于stm32f030水温控制5/po-4-9.png" alt=""></p><p>NTC对应的温度表这里就不发了,根据自己实际的电压才能使得AD对应的温度更精准</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/13/基于stm32f030水温控制5/po-1-5.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm32" scheme="https://syydnrycx.github.io/categories/stm32/"/>
    
    
      <category term="stm32" scheme="https://syydnrycx.github.io/tags/stm32/"/>
    
  </entry>
  
  <entry>
    <title>基于stm32f030水温控制4</title>
    <link href="https://syydnrycx.github.io/2018/04/13/%E5%9F%BA%E4%BA%8Estm32f030%E6%B0%B4%E6%B8%A9%E6%8E%A7%E5%88%B64/"/>
    <id>https://syydnrycx.github.io/2018/04/13/基于stm32f030水温控制4/</id>
    <published>2018-04-13T02:11:06.000Z</published>
    <updated>2018-04-22T03:01:40.624Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/13/基于stm32f030水温控制4/po-1-4.png" alt=""></p><a id="more"></a><div class="aplayer" data-id="522529247" data-server="netease" data-type="song"></div><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>  这一篇,说一下水温加热方面,这里水温加热这边,我们用的是固态继电器,一端连接加热棒,一端连接单片机驱动MOS电路.</p><p><img src="/2018/04/13/基于stm32f030水温控制4/po-3-1.png" alt=""></p><p>  从原理图可以看出,我们只要输出高低电平就可以实现水温加热,通过LED指示灯观察是否加热.</p><p>  既然用到了拉高拉低,既可以用周期性拉高拉低实现PWM,也可以使用定时器输出PWM,这里资源充足,所以用的是定时器配置PWM</p><h1 id="定时器PWM配置"><a href="#定时器PWM配置" class="headerlink" title="定时器PWM配置"></a>定时器PWM配置</h1><p>  配置这边,在图片里,也给了相应注释</p><p><img src="/2018/04/13/基于stm32f030水温控制4/po-3-2.png" alt=""></p><p>  配置方面可以根据自己实际需要去修改分频值与重装载值.</p><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><p>  配置好定时器后,我们如何通过实际来修改占空比，难道每次修改都要重新初始化一次吗?</p><p>  答案是不用的,stm32f0中库给出了修改占空比的函数,<code>TIM_SetCompare4(TIMx, duty);</code></p><p>  TIM_SetCompare4 后面的4标示了通道,TIMx通过更改x可以选择TIM1,TIM2等定时器, duty则是你要传入的占空比,这与你的重装值有关</p><p> <code>这里还需强调,我用的是stm32f030K6,系统时钟为48M.</code></p><p>  <code>PWM频率是由系统时钟除于你的分频值得到的,例如我设置分频值为2400则频率f = 48M / 2400 = 20000Hz = 20KHz,可以推算出计算周期为 = 1/20KHz = 0.00005s = 50us</code></p><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>  这一章配置定时器,十分简单的达到了加热的效果,如何达到水温控制,则要用到PID算法,这个后面再说.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/13/基于stm32f030水温控制4/po-1-4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm32" scheme="https://syydnrycx.github.io/categories/stm32/"/>
    
    
      <category term="stm32" scheme="https://syydnrycx.github.io/tags/stm32/"/>
    
  </entry>
  
  <entry>
    <title>基于stm32f030水温控制3</title>
    <link href="https://syydnrycx.github.io/2018/04/13/%E5%9F%BA%E4%BA%8Estm32f030%E6%B0%B4%E6%B8%A9%E6%8E%A7%E5%88%B63/"/>
    <id>https://syydnrycx.github.io/2018/04/13/基于stm32f030水温控制3/</id>
    <published>2018-04-12T23:12:07.000Z</published>
    <updated>2018-04-13T00:49:25.118Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/13/基于stm32f030水温控制3/po-1-3.jpg" alt=""><br><a id="more"></a></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><pre><code>上一篇,我们说到了旋转编码器EC11的实现,这篇我们讲一下数码管.首先,我的板上用到的数码管有两片,一片4位,分别用两个595驱动,节省IO口.数码管用的是3461BS,共阳极的数码管,驱动数码管,只需把我们的段码与位通过595发送到数码管的管脚,原理简单,这里就不多说了.</code></pre><h1 id="数码管配置"><a href="#数码管配置" class="headerlink" title="数码管配置"></a>数码管配置</h1><p><code>595连接芯片的IO分别是DIO-PB5 RCLK-PA15 SCLK-PB3,这里只要配置为推挽输出就可以了.</code></p><p><img src="/2018/04/13/基于stm32f030水温控制3/po-2-1.png" alt=""></p><p><img src="/2018/04/13/基于stm32f030水温控制3/po-2-2.png" alt=""></p><p><img src="/2018/04/13/基于stm32f030水温控制3/po-2-3.png" alt=""></p><h1 id="数码管显示配置"><a href="#数码管显示配置" class="headerlink" title="数码管显示配置"></a>数码管显示配置</h1><pre><code>先看显示这边,传入参数L1,L2,L3,L4分别对应数码管4个位所要显示的段码,H代表选择显示的是第一块数码管还是第二块</code></pre><p><code>0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80分别是位码</code></p><p><img src="/2018/04/13/基于stm32f030水温控制3/po-2-4.png" alt=""></p><p><img src="/2018/04/13/基于stm32f030水温控制3/po-2-5.png" alt=""></p><pre><code>最后把要显示的段码,通过函数传入.</code></pre><p><img src="/2018/04/13/基于stm32f030水温控制3/po-2-6.png" alt=""></p><pre><code>把要写入数码管的数据,写入函数 _3461BS_Date(u8 date),送入数码管.</code></pre><p><img src="/2018/04/13/基于stm32f030水温控制3/po-2-7.png" alt=""></p><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><pre><code>通过调用函数,我们可以实现静态显示,至于如何动态显示,我们后面再说.</code></pre><p><strong>最后贴上实物图:</strong></p><p><img src="/2018/04/13/基于stm32f030水温控制3/po-2-8.jpg" alt=""></p><p><img src="/2018/04/13/基于stm32f030水温控制3/po-2-9.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/13/基于stm32f030水温控制3/po-1-3.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm32" scheme="https://syydnrycx.github.io/categories/stm32/"/>
    
    
      <category term="stm32" scheme="https://syydnrycx.github.io/tags/stm32/"/>
    
  </entry>
  
  <entry>
    <title>基于stm32f030水温控制2</title>
    <link href="https://syydnrycx.github.io/2018/04/12/%E5%9F%BA%E4%BA%8Estm32f030%E6%B0%B4%E6%B8%A9%E6%8E%A7%E5%88%B62/"/>
    <id>https://syydnrycx.github.io/2018/04/12/基于stm32f030水温控制2/</id>
    <published>2018-04-12T13:19:50.000Z</published>
    <updated>2018-04-13T00:51:39.737Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/12/基于stm32f030水温控制2/po-1-1.jpg" alt=""><br><a id="more"></a></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>  承接上一篇的水温控制,这一篇我们把控制设定温度的旋转编码器EC11讲一下.</p><h2 id="EC11预备知识"><a href="#EC11预备知识" class="headerlink" title="EC11预备知识"></a>EC11预备知识</h2><p>  EC11旋转编码器是一种小型高精度旋转式编码器,在结构上,由编码器部分和按键部分组合而成,这里我用到了EC11A相和B相与一个按键.我们需要编写的就是如何判断旋转的方向与按键的检测.</p><p><img src="/2018/04/12/基于stm32f030水温控制2/po1-1.png" alt=""></p><p>  从图中我们可以看出,假设检测A相上升沿,我们只需判断B相的高低电平就可以知道旋转的是正向或是逆向,知道了如何检测,配置就方便多了,接下来我们讲一下如何配置.</p><h2 id="EC11配置"><a href="#EC11配置" class="headerlink" title="EC11配置"></a>EC11配置</h2><p><img src="/2018/04/12/基于stm32f030水温控制2/po1-2.png" alt=""></p><p>  时钟配置这边由于我的A相B相和按键所在IO都在PA上,所以我打开了GPIOA的时钟,由于需要映射中断管脚,所以开启了SYSCFG时钟.</p><p><img src="/2018/04/12/基于stm32f030水温控制2/po1-3.png" alt=""></p><p>  管脚配置这边,直接配置IO为上拉输入,这里有别与F1系列的我上一篇已经讲过了.这里就不多说了</p><p><img src="/2018/04/12/基于stm32f030水温控制2/po1-4.png" alt=""></p><p>  中断,要映射管脚,这里我用的是PA10,所以映射了中断线10,配置好中断,我们就只需要在中断函数里检测另一相的电平就可以了,这里我就不在多说了.</p><p><img src="/2018/04/12/基于stm32f030水温控制2/po1-5.png" alt=""></p><p>  最后设置一下中断优先级就可以了.</p><p><img src="/2018/04/12/基于stm32f030水温控制2/po1-6.png" alt=""></p><h2 id="按键配置"><a href="#按键配置" class="headerlink" title="按键配置"></a>按键配置</h2><p>  按键的配置其实上面已经有了,这里我们讲一下如何检测按键,通常扫按键的方法都是延时10ms,但是这种方式延时,不一定能达到我们要的效果.所以这里我介绍一下状态机按键消抖的方式.</p><p><img src="/2018/04/12/基于stm32f030水温控制2/po-1-7.png" alt=""></p><p><img src="/2018/04/12/基于stm32f030水温控制2/po-1-8.png" alt=""></p><p>  通过上面的状态跳转,实现判断按键抬起、长按、连按,相比延时扫描按键的方法,好了很多.</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>  这里简单的讲了EC11AB相的检测以及按键的扫描方法,如果文中有哪些错误,希望你能给我发邮件告知,感激不尽.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/12/基于stm32f030水温控制2/po-1-1.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm32" scheme="https://syydnrycx.github.io/categories/stm32/"/>
    
    
      <category term="stm32" scheme="https://syydnrycx.github.io/tags/stm32/"/>
    
  </entry>
  
  <entry>
    <title>基于stm32f030水温控制1</title>
    <link href="https://syydnrycx.github.io/2018/04/12/%E5%9F%BA%E4%BA%8Estm32f030%E6%B0%B4%E6%B8%A9%E6%8E%A7%E5%88%B61/"/>
    <id>https://syydnrycx.github.io/2018/04/12/基于stm32f030水温控制1/</id>
    <published>2018-04-12T07:00:26.000Z</published>
    <updated>2018-04-22T03:01:27.568Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2018/04/12/基于stm32f030水温控制1/po-1-1.jpg" alt=""><br><a id="more"></a></p><p><div class="aplayer" data-id="514055051" data-server="netease" data-type="song"></div></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>　这篇博客是基于我老师布置的项目”stm32f030水温控制”所写的,我会把每个模块的基本配置为大家进行讲解.好啦闲话不多说,进入我们的正题.</p><h2 id="LED和蜂鸣器的配置"><a href="#LED和蜂鸣器的配置" class="headerlink" title="LED和蜂鸣器的配置"></a>LED和蜂鸣器的配置</h2><p>　LED或者是蜂鸣器(BEEP)基本上是我们学习32的基础,配置这方面十分简单,所以我会简单的略过一些配置.</p><p>  我的板上LED和蜂鸣器与单片机相连的IO口有三个,分别是LED1-PA11 LED2-PA12 BEEP-PA0,接下来我们就说一下如何配置.</p><p>  首先,我们需要定义GPIO结构体与PA口的时钟,这里有别与F1系列的配置,F0PA口上的时钟是在AHB总线上,而F1PA口上的时钟是APB2,所以这里我们要区分一下,否则会报错.</p><p>  配置完时钟,我们就可以对IO口进行配置了,这里我设置了IO口为推挽输出,速度为50MHz,</p><p><img src="/2018/04/12/基于stm32f030水温控制1/2.png" alt=""><br>  这里要强调的是,F0区别与F1的是,IO口配置这边,不能直接像F1一样推挽和输出是同时配置的,F0是分别配置的,还有就是右击IO口速度那里,我们可以看到:</p><p><img src="/2018/04/12/基于stm32f030水温控制1/3.png" alt=""></p><p><img src="/2018/04/12/基于stm32f030水温控制1/4.png" alt=""></p><p>  可以看出,如果我们使用GPIO_Speed_Level_3也可以代替GPIO_Speed_50MHz,可以更直观的看出IO口速度,具体怎样选择,还是得看个人选择.</p><p>  最后,在配置一下GPIO_Init函数就基本配置完成.</p><p>  那么,我们如何使得LED翻转呢,这里就可以用到GPIO_SetBits和GPIO_ResetBits两个函数,不过我还是喜欢用F1的位带操作.所以等一下,我们讲一下如何配置F0来实现位带操作.</p><p><img src="/2018/04/12/基于stm32f030水温控制1/5.png" alt=""></p><h2 id="位带操作的配置"><a href="#位带操作的配置" class="headerlink" title="位带操作的配置"></a>位带操作的配置</h2><p>  位带操作,可以使我们输出高低电平时给1 or 0来实现,这样可以方便我们操控IO口,而且方便快捷,如果用操作函数的方式,翻转IO口就有点麻烦,所以这里我们设置下位带操作.</p><p>  我们可以在所在的工程中添加stm32f0xx_sys.h的头文件来存放,当我们需要使用位带操作时,直接调用就可以了.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __STM32F0xx_SYS_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __STM32F0xx_SYS_H</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b0   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b1   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b2   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b3   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b4   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b5   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b6   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b7   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b8   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b9   : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b10  : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b11  : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b12  : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b13  : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b14  : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> b15  : <span class="number">1</span>;</span><br><span class="line">&#125;REG16_TypeDef;</span><br><span class="line"></span><br><span class="line"><span class="comment">//IO口地址映射</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOA_ODR_Addr (GPIOA_BASE+0x14) <span class="comment">//0x48000014</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOB_ODR_Addr (GPIOB_BASE+0x14) <span class="comment">//0x48000414</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOC_ODR_Addr (GPIOC_BASE+0x14) <span class="comment">//0x48000814</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOD_ODR_Addr (GPIOD_BASE+0x14) <span class="comment">//0x48000C14</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOE_ODR_Addr (GPIOE_BASE+0x14) <span class="comment">//0x48001014</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOF_ODR_Addr (GPIOF_BASE+0x14) <span class="comment">//0x48001414</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOA_IDR_Addr (GPIOA_BASE+0x10) <span class="comment">//0x48000010</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOB_IDR_Addr (GPIOB_BASE+0x10) <span class="comment">//0x48000410</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOC_IDR_Addr (GPIOC_BASE+0x10) <span class="comment">//0x48000810</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOD_IDR_Addr (GPIOD_BASE+0x10) <span class="comment">//0x48000C10</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOE_IDR_Addr (GPIOE_BASE+0x10) <span class="comment">//0x48001010</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GPIOF_IDR_Addr (GPIOF_BASE+0x10) <span class="comment">//0x48001410</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//IO口操作,只对单一的IO口!</span></span><br><span class="line"><span class="comment">//确保n的值小于16!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PAout ((volatile REG16_TypeDef *)GPIOA_ODR_Addr)  <span class="comment">//输出 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PAin  ((volatile REG16_TypeDef *)GPIOA_IDR_Addr)  <span class="comment">//输入 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PBout ((volatile REG16_TypeDef *)GPIOB_ODR_Addr)  <span class="comment">//输出 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PBin  ((volatile REG16_TypeDef *)GPIOB_IDR_Addr)  <span class="comment">//输入 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PCout ((volatile REG16_TypeDef *)GPIOC_ODR_Addr)  <span class="comment">//输出 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PCin  ((volatile REG16_TypeDef *)GPIOC_IDR_Addr)  <span class="comment">//输入 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PDout ((volatile REG16_TypeDef *)GPIOD_ODR_Addr)  <span class="comment">//输出 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PDin  ((volatile REG16_TypeDef *)GPIOD_IDR_Addr)  <span class="comment">//输入 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PEout ((volatile REG16_TypeDef *)GPIOE_ODR_Addr)  <span class="comment">//输出 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PEin  ((volatile REG16_TypeDef *)GPIOE_IDR_Addr)  <span class="comment">//输入</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PFout ((volatile REG16_TypeDef *)GPIOF_ODR_Addr)  <span class="comment">//输出 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PFin  ((volatile REG16_TypeDef *)GPIOF_IDR_Addr)  <span class="comment">//输入</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> u8;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> u16;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> u32;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>  这样位带操作就已经配置好了.</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>  因为时间的问题,我没有办法把整个工程一次性讲完,所以我会分篇讲解,今天就先说的这里,我只是个学生,如果在文章中有什么错误的地方,请不吝指教,谢谢！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/04/12/基于stm32f030水温控制1/po-1-1.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="stm32" scheme="https://syydnrycx.github.io/categories/stm32/"/>
    
    
      <category term="stm32" scheme="https://syydnrycx.github.io/tags/stm32/"/>
    
  </entry>
  
</feed>
